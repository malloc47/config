#!/bin/bash
EXPECTED_ARGS=1
E_BADARGS=65
if [ $# -lt $EXPECTED_ARGS ]
then
  echo "Usage: `basename $0` [directory]"
  exit $E_BADARGS
fi
git filter-branch -f --prune-empty --index-filter "git rm -rf --cached --ignore-unmatch $1"
git reflog expire --expire=now --all
git gc --aggressive --prune=now
git prune
git gc --aggressive
git repack
git repack -ad
git prune-packed
